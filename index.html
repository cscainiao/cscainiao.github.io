<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>熊星的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="熊星的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="熊星的博客">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="熊星的博客">
  
    <link rel="alternate" href="/atom.xml" title="熊星的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">熊星的博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-mysql基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/26/mysql基础/" class="article-date">
  <time datetime="2018-05-26T06:53:58.000Z" itemprop="datePublished">2018-05-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/26/mysql基础/">mysql基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="安装mysql请自行百度"><a href="#安装mysql请自行百度" class="headerlink" title="安装mysql请自行百度"></a>安装mysql请自行百度</h3><h2 id="启动mysql数据库"><a href="#启动mysql数据库" class="headerlink" title="启动mysql数据库"></a>启动mysql数据库</h2><p>1.运行窗口servers.msc里面选择mysql服务启动</p>
<p>2.在命令窗口输入net start mysql57 </p>
<h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><h3 id="1-简述"><a href="#1-简述" class="headerlink" title="1.简述"></a>1.简述</h3><ul>
<li>SQL(Structured Query Language): 结构化查询语言(关系型数据库的编程语言)</li>
<li>DDL(数据定义语言): create(创建) / drop(删除) / alter(修改)</li>
<li>DML(数据操纵语言): insert(插入) / delete(删除) / update(更新) </li>
<li>DQL(数据查询语言): select(选择)</li>
<li>DCL(数据控制语言): grant(授予权限) / revoke(召回权限) / begin(开启事务) / commit(提交事务) / rollback(回滚事务)</li>
</ul>
<h3 id="2-创建删除数据库"><a href="#2-创建删除数据库" class="headerlink" title="2.创建删除数据库"></a>2.创建删除数据库</h3><ul>
<li>创建数据库并指定默认的字符集</li>
</ul>
<p>​    create database school default charset utf8;</p>
<ul>
<li><p>如果指定的数据库存在则删除该数据库</p>
<p> drop database if exists school;</p>
</li>
<li><p>切换到创建的数据库</p>
</li>
</ul>
<p>​    use school;</p>
<h3 id="3-关系型数据库的完整性指的是什么"><a href="#3-关系型数据库的完整性指的是什么" class="headerlink" title="3.关系型数据库的完整性指的是什么"></a>3.关系型数据库的完整性指的是什么</h3><ol>
<li>实体完整性: 每条记录都是独一无二的(主键/唯一约束/唯一索引)</li>
<li>参照完整性: 表中的数据要参照其他表已有的数据(外键)</li>
<li>域完整性: 数据是有效的(数据类型/非空约束/默认值约束/检查约束)</li>
</ol>
<h3 id="4-表的设计原则-范式理论-1NF-2NF-3NF-BCNF"><a href="#4-表的设计原则-范式理论-1NF-2NF-3NF-BCNF" class="headerlink" title="4.表的设计原则: 范式理论(1NF / 2NF / 3NF / BCNF)"></a>4.表的设计原则: 范式理论(1NF / 2NF / 3NF / BCNF)</h3><ul>
<li><p>范式级别指的是表设计的规范程度, 范式级别越高规范程度也就越高</p>
<p> 范式级别越高在插入/删除/更新数据时可能发生的问题就越少<br>而且表中的数据冗余度(重复)也就越低<br> 实际开发中往往会降低范式级别来提升查询数据的性能<br>1NF - 列的属性值不能够再拆分<br>2NF - 除了主键列之外的列要完全依赖于主键<br>场景: 不同学院的学生可能有相同的学号<br>学生表(stuid, sname, ssex, did, dname, dtel)<br>主键(stuid, did)<br>sname和ssex依赖于stuid, 而dname和dtel依赖于depid<br>这种依赖是部分依赖而不是完全依赖所以不满足2NF<br>3NF - 消除传递依赖<br>场景: 整个学校学生的学号是唯一的<br>学生表(stuid, sname, ssex, did, dname, dtel)<br>主键(stuid)</p>
</li>
</ul>
<h3 id="mysql实际应用-学校选课系统"><a href="#mysql实际应用-学校选课系统" class="headerlink" title="mysql实际应用(学校选课系统)"></a>mysql实际应用(学校选课系统)</h3><ul>
<li><p>1.创建学生表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_student</span><br><span class="line">(</span><br><span class="line">stuid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'学号'</span>,</span><br><span class="line">sname <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'姓名'</span>,</span><br><span class="line">ssex <span class="built_in">bit</span> <span class="keyword">default</span> <span class="number">1</span> <span class="keyword">comment</span> <span class="string">'性别'</span>,</span><br><span class="line">stel <span class="built_in">char</span>(<span class="number">11</span>) <span class="keyword">comment</span> <span class="string">'联系电话'</span>,</span><br><span class="line">sbirth <span class="built_in">date</span> <span class="keyword">comment</span> <span class="string">'出生日期'</span>,</span><br><span class="line">primary <span class="keyword">key</span> (stuid) <span class="comment">-- 主键(primary key): 能够标识唯一一条记录的一个或多个列</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>2.修改学生表</p>
<ul>
<li><p>添加列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_student <span class="keyword">add</span> <span class="keyword">column</span> saddr <span class="built_in">varchar</span>(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_student <span class="keyword">drop</span> <span class="keyword">column</span> stel;</span><br></pre></td></tr></table></figure>
</li>
<li><p>插入学生记录</p>
<p>1.插入所有列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_student <span class="keyword">values</span> (<span class="number">1001</span>, <span class="string">'王大锤'</span>, <span class="number">1</span>, <span class="string">'1990-2-12'</span>, <span class="string">'四川成都'</span>);</span><br></pre></td></tr></table></figure>
<p>2.插入指定列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_student (sname, stuid) <span class="keyword">values</span> (<span class="string">'骆昊'</span>, <span class="number">1002</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_student (stuid, sname, ssex) <span class="keyword">values</span> (<span class="number">1003</span>, <span class="string">'杨飘飘'</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>3.一次插入多行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_student <span class="keyword">values</span> </span><br><span class="line">(<span class="number">1004</span>, <span class="string">'张三丰'</span>, <span class="number">1</span>, <span class="string">'1940-12-3'</span>, <span class="string">'湖北武汉'</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="string">'黄蓉'</span>, <span class="number">0</span>, <span class="string">'1975-3-25'</span>, <span class="string">'山东东营'</span>),</span><br><span class="line">(<span class="number">1006</span>, <span class="string">'杨过'</span>, <span class="number">1</span>, <span class="string">'1987-1-19'</span>, <span class="string">'湖南长沙'</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> tb_student <span class="keyword">where</span> stuid=<span class="number">1003</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新数据:通常情况下更新或删除单条数据都是以ID字段(主键)作为条件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> tb_student <span class="keyword">set</span> sbirth=<span class="string">'1980-11-28'</span>, saddr=<span class="string">'四川德阳'</span> </span><br><span class="line"><span class="keyword">where</span> sname=<span class="string">'骆昊'</span>;</span><br><span class="line"><span class="comment">-- update tb_student set saddr='四川绵阳' </span></span><br><span class="line"><span class="comment">-- where stuid=1004 or stuid=1005 or stuid=1006;</span></span><br><span class="line"><span class="keyword">update</span> tb_student <span class="keyword">set</span> saddr=<span class="string">'四川绵阳'</span> </span><br><span class="line"><span class="keyword">where</span> stuid <span class="keyword">in</span> (<span class="number">1004</span>, <span class="number">1005</span>, <span class="number">1006</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>3.创建课程表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_course</span><br><span class="line">(</span><br><span class="line">courseid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'课程编号'</span>,</span><br><span class="line">cname <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'课程名称'</span>,</span><br><span class="line">ccredit <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'学分'</span>,</span><br><span class="line">primary <span class="keyword">key</span> (courseid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<ul>
<li><p>插入课程数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_course (courseid, cname, ccredit) <span class="keyword">values</span> </span><br><span class="line">(<span class="number">1111</span>, <span class="string">'Python程序设计'</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="number">2222</span>, <span class="string">'HTML程序设计'</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="number">3333</span>, <span class="string">'Linux操作系统'</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="number">4444</span>, <span class="string">'数据库基础'</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>4.创建学生选课表</p>
<p>关系型数据用两种表无法表示实体之间的多对多关联,可以通过中间表来建立学生和课程之间的多对多关系</p>
<p>在实际开发中不建议使用复合主键而且尽可能使用跟业务无关的列做主键,int类型的主键可以auto_increment设置为自增主键</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> tb_sc</span><br><span class="line">(</span><br><span class="line">scid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment <span class="keyword">comment</span> <span class="string">'选课编号'</span>,</span><br><span class="line"><span class="keyword">sid</span> <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'学生编号'</span>,</span><br><span class="line">cid <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'课程编号'</span>,</span><br><span class="line">score <span class="built_in">float</span> <span class="keyword">comment</span> <span class="string">'考试成绩'</span>,</span><br><span class="line">primary <span class="keyword">key</span> (scid)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加外键约束</span></span><br><span class="line"><span class="comment">-- 学生选课表中的学生编号参照了学生表的学号</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_sc <span class="keyword">add</span> <span class="keyword">constraint</span> fk_sc_sid </span><br><span class="line">foreign <span class="keyword">key</span> (<span class="keyword">sid</span>) <span class="keyword">references</span> tb_student (stuid);</span><br><span class="line"><span class="comment">-- 学生选课表中的课程编号参照了课程表的课程编号</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tb_sc <span class="keyword">add</span> <span class="keyword">constraint</span> fk_sc_cid </span><br><span class="line">foreign <span class="keyword">key</span> (cid) <span class="keyword">references</span> tb_course (courseid);</span><br></pre></td></tr></table></figure>
</li>
<li><p>插入学生选课数据</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> tb_sc (<span class="keyword">sid</span>, cid, score) <span class="keyword">values</span> </span><br><span class="line">(<span class="number">1001</span>, <span class="number">1111</span>, <span class="number">90</span>),</span><br><span class="line">(<span class="number">1001</span>, <span class="number">2222</span>, <span class="number">80</span>),</span><br><span class="line">(<span class="number">1001</span>, <span class="number">3333</span>, <span class="number">70</span>),</span><br><span class="line">(<span class="number">1001</span>, <span class="number">4444</span>, <span class="number">60</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="number">1111</span>, <span class="number">60</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="number">3333</span>, <span class="number">95</span>),</span><br><span class="line">(<span class="number">1002</span>, <span class="number">4444</span>, <span class="number">68</span>),</span><br><span class="line">(<span class="number">1004</span>, <span class="number">1111</span>, <span class="number">55.5</span>),</span><br><span class="line">(<span class="number">1004</span>, <span class="number">4444</span>, <span class="number">45.5</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="number">1111</span>, <span class="number">87.5</span>), </span><br><span class="line">(<span class="number">1005</span>, <span class="number">3333</span>, <span class="number">63</span>),</span><br><span class="line">(<span class="number">1005</span>, <span class="number">4444</span>, <span class="number">72.5</span>),</span><br><span class="line">(<span class="number">1006</span>, <span class="number">1111</span>, <span class="number">78.5</span>),</span><br><span class="line">(<span class="number">1006</span>, <span class="number">4444</span>, <span class="number">35</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询:</p>
<ul>
<li><p>查询所有学生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_course;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student, tb_course; <span class="comment">-- 笛卡尔积</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>投影和别名: 查询所有课程名称和学分</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname <span class="keyword">as</span> 姓名, ssex <span class="keyword">as</span> 性别 <span class="keyword">from</span> tb_student;</span><br><span class="line"><span class="keyword">select</span> sname <span class="keyword">as</span> 姓名, <span class="keyword">case</span> ssex <span class="keyword">when</span> <span class="number">1</span> <span class="keyword">then</span> <span class="string">'男'</span> <span class="keyword">else</span> <span class="string">'女'</span> <span class="keyword">end</span>  <span class="keyword">as</span> 性别 <span class="keyword">from</span> tb_student;</span><br><span class="line"><span class="keyword">select</span> cname <span class="keyword">as</span> 课程名, ccredit <span class="keyword">as</span> 学分 <span class="keyword">from</span> tb_course;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询所有女学生的姓名和出生日期</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname, sbirth <span class="keyword">from</span> tb_student <span class="keyword">where</span> ssex=<span class="number">0</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询所有学分大于2的课程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> courseid, cname <span class="keyword">from</span> tb_course <span class="keyword">where</span> ccredit&gt;<span class="number">2</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询所有80后学生的姓名,性别和出生日期</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname, ssex, sbirth <span class="keyword">from</span> tb_student</span><br><span class="line"><span class="keyword">where</span> <span class="string">'1980-1-1'</span>&lt;=sbirth <span class="keyword">and</span> sbirth&lt;=<span class="string">'1989-12-31'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> sname, ssex, sbirth <span class="keyword">from</span> tb_student</span><br><span class="line"><span class="keyword">where</span> sbirth <span class="keyword">between</span> <span class="string">'1980-1-1'</span> <span class="keyword">and</span> <span class="string">'1989-12-31'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>模糊查询:查询姓杨的学生姓名和性别</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student <span class="keyword">where</span> sname=<span class="string">'杨过'</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student <span class="keyword">where</span> sname <span class="keyword">like</span> <span class="string">'杨%'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>模糊查询: 查询姓杨的名字总共两个字的学生的姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student <span class="keyword">where</span> sname <span class="keyword">like</span> <span class="string">'杨_'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>模糊查询: 查询姓杨的名字总共三个字的学生的姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student <span class="keyword">where</span> sname <span class="keyword">like</span> <span class="string">'杨__'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>模糊查询: 查询带杨的名字的学生的姓名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from tb_student where sname like &apos;%杨%&apos;;</span><br></pre></td></tr></table></figure>
</li>
<li><p>多条件和控制处理: 查询没有录入生日和家庭住址的学生姓名, 判断一个列是否为null的时候不能用=或&lt;&gt; 而要用is或者is not</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student <span class="keyword">where</span> sbirth <span class="keyword">is</span> <span class="literal">null</span> <span class="keyword">or</span> saddr <span class="keyword">is</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>去重:查询学生的籍贯 关键字distinct</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">DISTINCT</span> saddr <span class="keyword">from</span> tb_student <span class="keyword">where</span> saddr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>排序 查询送学生的姓名和生日按年龄从大到小排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> tb_student <span class="keyword">order</span> <span class="keyword">by</span> ssex <span class="keyword">asc</span>, sbirth <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>筛和排序: 先筛选后排序<br>查询所有录入了家庭地址的男学生的姓名,出生日期和家庭住址按年龄从小到大排列</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname, sbirth, saddr <span class="keyword">from</span> tb_student </span><br><span class="line"><span class="keyword">where</span> saddr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">and</span> ssex=<span class="number">1</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sbirth <span class="keyword">desc</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>聚合函数:查询年龄最大的学生的出生日期<br>max()/min()/sum/ avg()求平均/ count()计数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">min</span>(sbirth) <span class="keyword">from</span> tb_student;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">max</span>(sbirth) <span class="keyword">from</span> tb_student;</span><br><span class="line"><span class="comment">-- 查询男女学生的人数group by:分组,默认分组会排序,如果</span></span><br><span class="line"><span class="comment">-- 不需要排序,可以在后面增加order by null 增加语句性能</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(stuid) <span class="keyword">from</span> tb_Student;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">count</span>(stuid) <span class="keyword">from</span> tb_Student <span class="keyword">where</span> ssex=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">select</span> ssex, <span class="keyword">count</span>(stuid) <span class="keyword">from</span> tb_student <span class="keyword">group</span> <span class="keyword">by</span> ssex;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(ssex, <span class="string">'男'</span>, <span class="string">'女'</span>) <span class="keyword">as</span> 性别, <span class="keyword">count</span>(*) <span class="keyword">as</span> 人数</span><br><span class="line"><span class="keyword">from</span> tb_student <span class="keyword">group</span> <span class="keyword">by</span> ssex;</span><br><span class="line"><span class="comment">-- 先筛选(where) 再分组(group by)再筛选(having)再排序(order by)</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">if</span>(ssex, <span class="string">'男'</span>, <span class="string">'女'</span>) <span class="keyword">as</span> 性别, <span class="keyword">count</span>(*) <span class="keyword">as</span> 人数</span><br><span class="line"><span class="keyword">from</span> tb_student <span class="keyword">where</span> saddr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> ssex <span class="keyword">order</span> <span class="keyword">by</span> ssex <span class="keyword">desc</span>;</span><br><span class="line"><span class="comment">-- 聚合函数:查询课程编号为1111的课程的平均成绩</span></span><br><span class="line"><span class="keyword">select</span> cid, <span class="keyword">avg</span>(score) <span class="keyword">from</span> tb_sc <span class="keyword">where</span> cid=<span class="number">1111</span>;</span><br><span class="line"><span class="comment">-- 查询所有课程编号的平均成绩</span></span><br><span class="line"><span class="keyword">select</span> cid, <span class="keyword">avg</span>(score) <span class="keyword">from</span> tb_sc <span class="keyword">group</span> <span class="keyword">by</span> cid;</span><br><span class="line"><span class="comment">-- where 子句构造的筛选是分组以前的筛选</span></span><br><span class="line"><span class="comment">-- 如果希望对分组后的数据进行筛选 那么要用having</span></span><br><span class="line"><span class="keyword">select</span> cid, <span class="keyword">avg</span>(score) <span class="keyword">from</span> tb_sc </span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> cid <span class="keyword">having</span> <span class="keyword">avg</span>(score)&lt;<span class="number">60</span>;</span><br><span class="line"><span class="comment">-- 聚合函数: 查询学号为1001 的学生所有的课程的平均成绩'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span>, <span class="keyword">avg</span>(score) <span class="keyword">from</span> tb_sc <span class="keyword">where</span> <span class="keyword">sid</span>=<span class="number">1001</span>;</span><br><span class="line"><span class="comment">-- 查询每个学生的学号和平均成绩 把不及格的列出来</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span>, <span class="keyword">avg</span>(score) <span class="keyword">from</span> tb_sc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">avg</span>(score)&lt;<span class="number">60</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>子查询 查询年龄最大的学生的姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname, sbirth <span class="keyword">from</span> tb_student</span><br><span class="line"><span class="keyword">where</span> sbirth=(<span class="keyword">select</span> <span class="keyword">min</span>(sbirth) <span class="keyword">from</span> tb_student);</span><br><span class="line"><span class="keyword">select</span> sname, sbirth <span class="keyword">from</span> tb_student</span><br><span class="line"><span class="keyword">where</span> sbirth=(<span class="keyword">select</span> <span class="keyword">max</span>(sbirth) <span class="keyword">from</span> tb_student);</span><br><span class="line"><span class="comment">-- 子查询 查询选了两门以上的课程的学生姓名</span></span><br><span class="line"><span class="comment">-- sql and 语句先执行and右边的语句</span></span><br><span class="line"><span class="keyword">select</span> sname <span class="keyword">from</span> tb_student</span><br><span class="line"><span class="keyword">where</span> stuid <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sid</span> <span class="keyword">from</span> tb_sc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span> <span class="keyword">having</span> <span class="keyword">count</span>(<span class="keyword">sid</span>)&gt;<span class="number">2</span>) <span class="keyword">and</span> ssex=<span class="number">1</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>连接查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">- 连接查询 查询选课学生的姓名和平均成绩</span><br><span class="line"><span class="keyword">select</span> sname, avgscore <span class="keyword">from</span> tb_student,</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>, <span class="keyword">avg</span>(score) <span class="keyword">as</span> avgscore <span class="keyword">from</span> tb_sc</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">sid</span>) t</span><br><span class="line"><span class="keyword">where</span> stuid=<span class="keyword">sid</span>;</span><br><span class="line"><span class="comment">-- 连接查询:查询每个学生的姓名和选课数量</span></span><br><span class="line"><span class="keyword">select</span> sname,<span class="keyword">count</span> <span class="keyword">from</span> tb_student,</span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>, <span class="keyword">count</span>(cid) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> tb_sc <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">sid</span>) t <span class="keyword">where</span> stuid=<span class="keyword">sid</span>;</span><br><span class="line"><span class="comment">-- 内连接</span></span><br><span class="line"><span class="keyword">select</span> sname,cname,score <span class="keyword">from</span> tb_sc</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> tb_student <span class="keyword">on</span> <span class="keyword">sid</span>=stuid</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> tb_course <span class="keyword">on</span> cid=courseid</span><br><span class="line"><span class="comment">-- 左外连接, 左表不满足连表条件的记录也要查询出来</span></span><br><span class="line"><span class="keyword">select</span> sname,<span class="keyword">count</span> <span class="keyword">from</span> tb_student t1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>, <span class="keyword">count</span>(cid) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> tb_sc <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">sid</span>) t2 <span class="keyword">on</span> t1.stuid=t2.sid;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> sname,<span class="keyword">ifnull</span>(<span class="keyword">count</span>,<span class="number">0</span>) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> tb_student t1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>, <span class="keyword">count</span>(cid) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> tb_sc <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">sid</span>) t2 <span class="keyword">on</span> t1.stuid=t2.sid;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 右外连接:</span></span><br><span class="line"><span class="keyword">select</span> sname,<span class="keyword">ifnull</span>(<span class="keyword">count</span>,<span class="number">0</span>) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> </span><br><span class="line">(<span class="keyword">select</span> <span class="keyword">sid</span>, <span class="keyword">count</span>(cid) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> tb_sc <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">sid</span>) t2 <span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> tb_student t1  <span class="keyword">on</span> t1.stuid=t2.sid;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 全外连接:full outer join ,mysql不支持全外连接</span></span><br><span class="line"><span class="keyword">select</span> sname, cname,score</span><br><span class="line"><span class="keyword">from</span> tb_sc, tb_student, tb_course</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">sid</span>=stuid <span class="keyword">and</span> cid=courseid;</span><br></pre></td></tr></table></figure>
</li>
<li><p>分页查询,本语法只支持mysql,不支持其他数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,cname,score <span class="keyword">from</span> tb_sc</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> tb_student <span class="keyword">on</span> <span class="keyword">sid</span>=stuid</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> tb_course <span class="keyword">on</span> cid=courseid</span><br><span class="line"><span class="comment">-- limit 5;     -- 查询前面5条</span></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> score <span class="keyword">desc</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">0</span>, <span class="number">5</span>;    <span class="comment">-- 0可以设置偏移量</span></span><br><span class="line"><span class="comment">-- limit 5 offset 0;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="DCL-数据控制语言"><a href="#DCL-数据控制语言" class="headerlink" title="DCL(数据控制语言)"></a>DCL(数据控制语言)</h3><ul>
<li><p>创建用户并指定登录口令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> hellokitty <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">'123123'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>授予权限和召回权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> all <span class="keyword">on</span> school.tb_student <span class="keyword">to</span> hellokitty;</span><br><span class="line"><span class="keyword">revoke</span> all <span class="keyword">on</span> school.tb_student <span class="keyword">from</span> hellokitty;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> school.tb_student <span class="keyword">to</span> hellokitty;</span><br><span class="line"><span class="keyword">grant</span> all <span class="keyword">on</span> school.* <span class="keyword">to</span> hellokitty;</span><br><span class="line"><span class="keyword">grant</span> all <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="string">'hellokitty'</span>@<span class="string">'%'</span>;</span><br><span class="line"><span class="keyword">revoke</span> all <span class="keyword">on</span> *.* <span class="keyword">from</span> hellokitty;</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除用户</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">user</span> hellokitty;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="索引-相当于是一个目录-可以提升查询的效率-牺牲空间-节省时间"><a href="#索引-相当于是一个目录-可以提升查询的效率-牺牲空间-节省时间" class="headerlink" title="索引:相当于是一个目录,可以提升查询的效率,牺牲空间,节省时间"></a>索引:相当于是一个目录,可以提升查询的效率,牺牲空间,节省时间</h3><ul>
<li><p>创建索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> idx_emp_ename <span class="keyword">on</span> tbemp(ename);</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">index</span> idx_emp_ename;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">index</span> <span class="keyword">from</span> tbemp;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="事务-必须几个语句同时执行或者不执行"><a href="#事务-必须几个语句同时执行或者不执行" class="headerlink" title="事务:必须几个语句同时执行或者不执行"></a>事务:必须几个语句同时执行或者不执行</h3><ul>
<li><p>事务的特点 acid特性:<br>1.原子性:不可分割,要么全成功要么全失败<br>2.一致性:事务前后数据状态要保持一致<br>3.隔离性:多个事务不能看到对方的中间状态<br>4.持久性:事务完成后数据要持久化</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">begin</span></span><br><span class="line">语句<span class="number">1</span></span><br><span class="line">语句<span class="number">2</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">commit</span>/<span class="keyword">rollback</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="mysql实际应用"><a href="#mysql实际应用" class="headerlink" title="mysql实际应用"></a>mysql实际应用</h3><ul>
<li><p>人力管理系统</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建人力资源管理系统数据库</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">database</span> <span class="keyword">if</span> <span class="keyword">exists</span> HRS;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> HRS <span class="keyword">default</span> <span class="keyword">charset</span> utf8;</span><br><span class="line"><span class="comment">-- 切换数据库上下文环境</span></span><br><span class="line"><span class="keyword">use</span> HRS;</span><br><span class="line"><span class="comment">-- 删除表</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> TbEmp;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> TbDept;</span><br><span class="line"><span class="comment">-- 创建部门表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> TbDept</span><br><span class="line">(</span><br><span class="line">dno <span class="built_in">int</span>,										<span class="comment">-- 部门编号</span></span><br><span class="line">dname <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span>,	<span class="comment">-- 部门名称</span></span><br><span class="line">dloc <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,	<span class="comment">-- 部门所在地</span></span><br><span class="line">primary <span class="keyword">key</span> (dno)</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加部门记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> TbDept <span class="keyword">values</span> </span><br><span class="line">(<span class="number">10</span>, <span class="string">'会计部'</span>, <span class="string">'北京'</span>),</span><br><span class="line">(<span class="number">20</span>, <span class="string">'研发部'</span>, <span class="string">'成都'</span>),</span><br><span class="line">(<span class="number">30</span>, <span class="string">'销售部'</span>, <span class="string">'重庆'</span>),</span><br><span class="line">(<span class="number">40</span>, <span class="string">'运维部'</span>, <span class="string">'深圳'</span>);</span><br><span class="line"><span class="comment">-- 创建员工表</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> TbEmp</span><br><span class="line">(</span><br><span class="line">empno <span class="built_in">int</span> primary <span class="keyword">key</span>,			<span class="comment">-- 员工编号</span></span><br><span class="line">ename <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,	 <span class="comment">-- 员工姓名</span></span><br><span class="line">job <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span>,		<span class="comment">-- 员工职位</span></span><br><span class="line">mgr <span class="built_in">int</span>,					<span class="comment">-- 主管编号</span></span><br><span class="line">sal <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>,			<span class="comment">-- 员工月薪</span></span><br><span class="line">comm <span class="built_in">int</span>,					<span class="comment">-- 每月补贴</span></span><br><span class="line">dno <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span>			<span class="comment">-- 部门编号</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 添加外键约束</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> TbEmp <span class="keyword">add</span> <span class="keyword">constraint</span> fk_emp_dno foreign <span class="keyword">key</span> (dno) <span class="keyword">references</span> TbDept(dno);</span><br><span class="line"><span class="comment">-- 添加员工记录</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">low_priority</span> <span class="keyword">into</span> TbEmp <span class="keyword">values</span> </span><br><span class="line">(<span class="number">7800</span>, <span class="string">'张三丰'</span>, <span class="string">'总裁'</span>, <span class="literal">null</span>, <span class="number">9000</span>, <span class="number">1200</span>, <span class="number">20</span>),</span><br><span class="line">(<span class="number">2056</span>, <span class="string">'乔峰'</span>, <span class="string">'分析师'</span>, <span class="number">7800</span>, <span class="number">5000</span>, <span class="number">1500</span>, <span class="number">20</span>),</span><br><span class="line">(<span class="number">3088</span>, <span class="string">'李莫愁'</span>, <span class="string">'设计师'</span>, <span class="number">2056</span>, <span class="number">3500</span>, <span class="number">800</span>, <span class="number">20</span>),</span><br><span class="line">(<span class="number">3211</span>, <span class="string">'张无忌'</span>, <span class="string">'程序员'</span>, <span class="number">2056</span>, <span class="number">3200</span>, <span class="literal">null</span>, <span class="number">20</span>),</span><br><span class="line">(<span class="number">3233</span>, <span class="string">'丘处机'</span>, <span class="string">'程序员'</span>, <span class="number">2056</span>, <span class="number">3400</span>, <span class="literal">null</span>, <span class="number">20</span>),</span><br><span class="line">(<span class="number">3251</span>, <span class="string">'张翠山'</span>, <span class="string">'程序员'</span>, <span class="number">2056</span>, <span class="number">4000</span>, <span class="literal">null</span>, <span class="number">20</span>),</span><br><span class="line">(<span class="number">5566</span>, <span class="string">'宋远桥'</span>, <span class="string">'会计师'</span>, <span class="number">7800</span>, <span class="number">4000</span>, <span class="number">1000</span>, <span class="number">10</span>),</span><br><span class="line">(<span class="number">5234</span>, <span class="string">'郭靖'</span>, <span class="string">'出纳'</span>, <span class="number">5566</span>, <span class="number">2000</span>, <span class="literal">null</span>, <span class="number">10</span>),</span><br><span class="line">(<span class="number">3344</span>, <span class="string">'黄蓉'</span>, <span class="string">'销售主管'</span>, <span class="number">7800</span>, <span class="number">3000</span>, <span class="number">800</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">1359</span>, <span class="string">'胡一刀'</span>, <span class="string">'销售员'</span>, <span class="number">3344</span>, <span class="number">1800</span>, <span class="number">200</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">4466</span>, <span class="string">'苗人凤'</span>, <span class="string">'销售员'</span>, <span class="number">3344</span>, <span class="number">2500</span>, <span class="literal">null</span>, <span class="number">30</span>),</span><br><span class="line">(<span class="number">3244</span>, <span class="string">'欧阳锋'</span>, <span class="string">'程序员'</span>, <span class="number">3088</span>, <span class="number">3200</span>, <span class="literal">null</span>, <span class="number">20</span>),</span><br><span class="line">(<span class="number">3577</span>, <span class="string">'杨过'</span>, <span class="string">'会计'</span>, <span class="number">5566</span>, <span class="number">2200</span>, <span class="literal">null</span>, <span class="number">10</span>),</span><br><span class="line">(<span class="number">3588</span>, <span class="string">'朱九真'</span>, <span class="string">'会计'</span>, <span class="number">5566</span>, <span class="number">2500</span>, <span class="literal">null</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询薪资最高的员工姓名和工资 </span></span><br><span class="line"><span class="keyword">select</span> ename, sal <span class="keyword">from</span> tbemp <span class="keyword">where</span> sal=(<span class="keyword">select</span> <span class="keyword">max</span>(sal) <span class="keyword">from</span></span><br><span class="line">tbemp)</span><br><span class="line"><span class="comment">-- 查询员工的姓名和年薪((月薪+补贴)*13) 字符串连接 concat</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(job,<span class="string">':'</span>,ename) <span class="keyword">as</span> title, (sal + <span class="keyword">ifnull</span>(comm,<span class="number">0</span>))*<span class="number">13</span> s <span class="keyword">from</span> TBEmp <span class="keyword">order</span> <span class="keyword">by</span> s <span class="keyword">desc</span>; </span><br><span class="line"><span class="comment">-- 查询所有员工的部门的编号和人数</span></span><br><span class="line"><span class="keyword">select</span> dno, <span class="keyword">count</span>(ename) <span class="keyword">from</span> TBEmp <span class="keyword">group</span> <span class="keyword">by</span> dno;</span><br><span class="line"><span class="comment">-- 查询所有部门的名称和人数 , 用的左链接</span></span><br><span class="line"><span class="keyword">select</span> dname 部门名称, <span class="keyword">ifnull</span>(<span class="keyword">count</span>,<span class="number">0</span>) 部门人数 <span class="keyword">from</span> tbdept t1 <span class="keyword">left</span> <span class="keyword">outer</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> dno, <span class="keyword">count</span>(ename) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> TBEmp <span class="keyword">group</span> <span class="keyword">by</span> dno) </span><br><span class="line">t2 <span class="keyword">on</span> t1.dno=t2.dno;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询除老板外薪资最高的员工的姓名和工资</span></span><br><span class="line"><span class="keyword">select</span> ename, sal <span class="keyword">from</span> tbemp <span class="keyword">where</span> sal=(<span class="keyword">select</span> <span class="keyword">max</span>(sal) <span class="keyword">from</span></span><br><span class="line">tbemp <span class="keyword">where</span> mgr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span>)</span><br><span class="line"><span class="comment">-- 查询薪水超过平均薪水的员工的姓名和工资</span></span><br><span class="line"><span class="keyword">select</span> ename,sal <span class="keyword">from</span> tbemp</span><br><span class="line"><span class="keyword">where</span> sal&gt;(<span class="keyword">select</span> <span class="keyword">avg</span>(sal) <span class="keyword">from</span> tbemp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> ename, sal, avgsal <span class="keyword">from</span> tbemp t1</span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">avg</span>(sal) <span class="keyword">as</span> avgsal <span class="keyword">from</span> tbemp)</span><br><span class="line">t2 <span class="keyword">on</span> sal&gt;avgsal;</span><br><span class="line"><span class="comment">-- 查询薪水超过其所在部门平均薪水的员工的姓名、部门编号和工资</span></span><br><span class="line"><span class="keyword">select</span> ename, t1.dno,sal <span class="keyword">from</span> tbemp t1 <span class="keyword">inner</span> <span class="keyword">join</span></span><br><span class="line">(<span class="keyword">select</span> dno, <span class="keyword">avg</span>(sal) <span class="keyword">as</span> avgsal <span class="keyword">from</span> tbemp <span class="keyword">group</span> <span class="keyword">by</span></span><br><span class="line">dno) t2 <span class="keyword">on</span> t1.dno=t2.dno <span class="keyword">and</span> sal&gt;avgsal;</span><br><span class="line"><span class="comment">-- 查询部门中薪水最高的人姓名、工资和所在部门名称</span></span><br><span class="line"><span class="keyword">select</span> ename, sal, dname <span class="keyword">from</span> tbemp t1 <span class="keyword">inner</span> <span class="keyword">join</span>(</span><br><span class="line"> <span class="keyword">select</span> <span class="keyword">max</span>(sal) maxsal, dno <span class="keyword">from</span> tbemp <span class="keyword">group</span> <span class="keyword">by</span> dno) t2</span><br><span class="line"> <span class="keyword">on</span> t1.dno=t2.dno <span class="keyword">inner</span> <span class="keyword">join</span> </span><br><span class="line"> tbdept t3 <span class="keyword">on</span> t2.dno= t3.dno <span class="keyword">where</span> sal=maxsal;</span><br><span class="line"><span class="comment">-- 查询主管的姓名和职位</span></span><br><span class="line"><span class="comment">-- SQL 优化</span></span><br><span class="line"><span class="comment">-- 尽可能不使用distinck去重和in集合运算 可以使用exists和not exists替代</span></span><br><span class="line"><span class="keyword">select</span> ename, job <span class="keyword">from</span> tbemp</span><br><span class="line"><span class="keyword">where</span> empno <span class="keyword">in</span>(</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> mgr <span class="keyword">from</span> tbemp <span class="keyword">where</span> mgr <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">select</span> ename, job <span class="keyword">from</span> tbemp t1</span><br><span class="line"><span class="keyword">where</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="string">'x'</span> <span class="keyword">from</span> tbemp t2 <span class="keyword">where</span> t1.empno=t2.mgr)</span><br><span class="line"><span class="comment">-- 查询薪资排名4~6名的员工姓名和工资</span></span><br><span class="line"><span class="keyword">select</span> ename, sal <span class="keyword">from</span> tbemp</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span></span><br><span class="line"><span class="keyword">limit</span> <span class="number">3</span>, <span class="number">3</span>;</span><br></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/26/mysql基础/" data-id="cjhrnspk80001wq6axntum3sg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-django" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/26/django/" class="article-date">
  <time datetime="2018-05-26T04:57:44.000Z" itemprop="datePublished">2018-05-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/05/26/django/">django(实战01)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/26/django/" data-id="cjhrnspjo0000wq6aycrhiywa" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/05/26/mysql基础/">mysql基础</a>
          </li>
        
          <li>
            <a href="/2018/05/26/django/">django(实战01)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>